
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	
	
	
  
  <title>Build a Ruby Gem Email Course - Testing | Brandon Hilkert</title>
	<meta name="author" content="Brandon Hilkert">

	<meta name="description" content="Building a Ruby Gem from scratch can be challenging if you're not familiar with the conventions. Join my free 10-day course to learn how to build your own Ruby &hellip;">
	

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@brandonhilkert">
  <meta name="twitter:title" content="Build a Ruby Gem Email Course - Testing">
  <meta name="twitter:description" content="Building a Ruby Gem from scratch can be challenging if you're not familiar with the conventions. Join my free 10-day course to learn how to build your own Ruby gems from scratch.">
  <meta name="twitter:image" content="http://brandonhilkert.com/images/brandon-hilkert.jpg">

  <meta property="og:title" content="Build a Ruby Gem Email Course - Testing | Brandon Hilkert"/>
  <meta property="og:url" content="http://brandonhilkert.com/courses/build-a-ruby-gem/testing.html"/>
  <meta property="og:site_name" content="Brandon Hilkert's Blog"/>
  <meta property="og:type" content="blog"/>

	<link href="/atom.xml" rel="alternate" title="Build a Ruby Gem Email Course - Testing | Brandon Hilkert" type="application/atom+xml">
	<link rel="canonical" href="http://brandonhilkert.com/courses/build-a-ruby-gem/testing.html">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Sorts+Mill+Goudy:400,400italic' rel='stylesheet' type='text/css'>
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300" rel="stylesheet" type="text/css">
  <link rel="author" href="https://plus.google.com/u/0/116002935339410846674" />
  <script src="/javascripts/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>


<body>
	<div class="container">
		<div class="left-col">
			<header id="header"><div class="profilepic">
  <a href="/">
    <img src="/images/brandon-hilkert.jpg" width="80" height="80" alt="Brandon Hilkert Profile Picture" />
  </a>
</div>
<hgroup>
  <h1><a href="/">Brandon Hilkert</a></h1>
  
</hgroup>

<nav id="main-nav">
  <ul class="main-navigation">
    <li><a href="/about">About</a></li>
    <li><a href="/">Blog</a></li>
    <li><a href="/newsletter">Newsletter</a></li>
    <li><a href="http://railsmasterclass.com" target="_blank">Workshop</a></li>
  </ul>
  <section class="aboutme">
    <p>
      Hi. I'm Brandon.
      <br />
      I'm a technology entrepreneur in PA.
    </p>
  </section>
</nav>

<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/brandonhilkert" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/brandonhilkert" title="GitHub">GitHub</a>
		
		
		<a class="linkedin" href="http://www.linkedin.com/in/brandonhilkert">LinkedIn</a>
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>

</header>
		</div>
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
  <div class="date">








  


<time datetime="2013-12-04T05:43:00-05:00" data-updated="true" itemprop="datePublished">December 4<span>th</span>, 2013</time></div>
	<h1 class="title" itemprop="name">Build a Ruby Gem Email Course - Testing</h1>
  <div class="tags">


	<a class='category' href='/blog/categories/course/'>course</a>, <a class='category' href='/blog/categories/email/'>email</a>, <a class='category' href='/blog/categories/gem/'>gem</a>, <a class='category' href='/blog/categories/open-source/'>open source</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	<div class="entry-content" itemprop="articleBody"><p><em>This post is a part of a free 10-day email course on Building a Ruby Gem. You
can find the others posts in the series below:</em></p>

<p><em><a href="/courses/build-a-ruby-gem/background.html">Background</a> &ndash;>
<a href="/courses/build-a-ruby-gem/structure.html">Structure</a> &ndash;>
Testing &ndash;></em></p>

<p>Last time, I closed with suggesting to think about the public API and how
the gem will be used in our application.</p>

<h3>README-Driven Development</h3>

<p>It&rsquo;s a thing&hellip;really. The guys at Github have talked about this before. Tom
Preston-Werner posted this article about <a href="http://tom.preston-werner.com/2010/08/23/readme-driven-development.html">the benefits of readme-driven
development</a>
and Zach Holman (another Github employee), gave <a href="http://zachholman.com/talk/a-documentation-talk/">this talk on the subject of
documentation</a> in the
development cycle.</p>

<p>I want to stress that if you want your new gem to be used by anyone other than
yourself, write a an accompanying README. If that alone doesn&rsquo;t convince, I can
tell you about the countless times that I have worked on something, only to
come back a month, or even days, later and had no idea of my intent or what I
was thinking. In this case, a README about the usage of the gem would&rsquo;ve served
me well.</p>

<p>Here&rsquo;s why I think you should write the README first:</p>

<ol>
<li><p>It forces you define the public API up front. This reduces your tendency to
over-engineer or write any code that won&rsquo;t ultimately get you to the finish
line (I&rsquo;ve found that it&rsquo;s really easy to get carried away by the excitement
or writing killer code).</p></li>
<li><p>It moves the somewhat annoying part of documentation to the beginning. When
you write that last bit of and finally release your gem, the last thing
you&rsquo;ll want to do is get bogged down with writing documentation. Truthfully,
it&rsquo;s not that much fun. So if you can offload it to the beginning of the
process, you&rsquo;ll be better off.</p></li>
<li><p>You <strong>WILL</strong> forget how your gem works&hellip;so if you want anyone else to use
it, or even yourself at a later time, write a README that demonstrates
installation, usage and contact.</p></li>
</ol>


<p>OK, so now that I&rsquo;ve convinced you this is good thing, let&rsquo;s get to work!</p>

<h3>README</h3>

<p>In the last lesson, we created the skeleton of our new gem using bundler. Pop
open the folder again and notice that it generated a <code>README.md</code> for us. Most
people use Markdown for these files, but you&rsquo;re free to use whatever you are
conformable with and gets the point across.</p>

<p>You can <a href="https://github.com/brandonhilkert/so_meta_course/commit/2bdb1b7462fec6d68cd377b3ac0199ea70cfa5e4">see the changes in
Github</a>.
I have sections for installation and setup, several sections on usage (because
it involves some setup outside of the view helper) and contributing/contact.</p>

<h3>Default Files</h3>

<p>I want to take a quick step backwards and take a look at all the files bundler
generated for us. If you open your gem directory, it looks something like this:</p>

<figure class='code'><pre><code>├── Gemfile
├── LICENSE.txt
├── README.md
├── Rakefile
├── lib
│   ├── so_meta
│   │   └── version.rb
│   └── so_meta.rb
└── so_meta.gemspec</code></pre></figure>


<p>Notice the <code>LICENSE.txt</code> file. The default license is
<a href="http://opensource.org/licenses/MIT">MIT</a>. It basically says that the code can
be used for ANYTHING and ANYONE wants without permission or compensation. It
seems that most open source projects use this license. If you&rsquo;re unsure, and
have intentions to make your gem open source, stick to this one.</p>

<p>We touched on the <code>README.md</code> file above&hellip;</p>

<p>The <code>Rakefile</code> is a file used to define and organize tasks that we&rsquo;ll run from
a command prompt. You&rsquo;ll see more examples of this later and we&rsquo;ll add some
during our discussion about testing. By default, it includes the following:</p>

<figure class='code'><pre><code>require "bundler/gem_tasks"</code></pre></figure>


<p>Bundler has some built-in tasks to help when we finally release our gem. We&rsquo;ll
take a look at the details when we get to that point.</p>

<p>I briefly mentioned last time that the <code>lib</code> directory should include a single
file (which it does) with the name of your gem, and a folder with the same name
that includes the rest of your code. This folder doesn&rsquo;t have to necessarily be
used, but we&rsquo;ll see later than the <code>so_meta.rb</code> file in here can get
complicated fast if we don&rsquo;t take advantage of this convention.</p>

<p>Lastly, the gem spec (so_meta.gemspec). It&rsquo;s repopulated to encourage you to fill it in.</p>

<figure class='code'><pre><code># coding: utf-8
lib = File.expand_path('../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)
require 'so_meta/version'

Gem::Specification.new do |spec|
  spec.name          = "so_meta"
  spec.version       = SoMeta::VERSION
  spec.authors       = ["Brandon Hilkert"]
  spec.email         = ["brandonhilkert@gmail.com"]
  spec.description   = %q{TODO: Write a gem description}
  spec.summary       = %q{TODO: Write a gem summary}
  spec.homepage      = ""
  spec.license       = "MIT"

  spec.files         = `git ls-files`.split($/)
  spec.executables   = spec.files.grep(%r{^bin/}) { |f| File.basename(f) }
  spec.test_files    = spec.files.grep(%r{^(test|spec|features)/})
  spec.require_paths = ["lib"]

  spec.add_development_dependency "bundler", "~&gt; 1.3"
  spec.add_development_dependency "rake"
end</code></pre></figure>


<p>The first 2 lines adds the <code>lib</code> directory to our load path (the path that ruby will look for external libraries). This will allow us to call <code>require "so_meta"</code> from our application and have it work. The simplicity it offers is powerful and I&rsquo;ve never found a need to change, so I would stick with the defaults here.</p>

<p>The first section within the specification block is some metadata about you and the gem. It&rsquo;s worth filling out and providing as much information as you can. It&rsquo;ll be helpful for those that use your gem. And when we finally release it to rubygems.org, you&rsquo;ll see how those details are use to fill out the landing page for your gem.</p>

<p>The middle section should <strong>NOT</strong> be modified. It uses <code>git</code> and the some details about the directory structure to define which files are active.</p>

<p>The last section is where the dependencies of your gem are specified. When used within your application, <code>bundler</code> will read these details and install the other gems listed here if you need them for your gem to work properly. There&rsquo;s 2 dependency methods to be aware of:</p>

<p><code>spec.add_development_dependency "rake"</code> defines a development dependency (hence the name) &ndash; this will NOT be installed when the gem is used in a production application.</p>

<p><code>spec.add_dependency "redis"</code> defines a dependency needed in all environments.</p>

<p>Here, <a href="https://github.com/brandonhilkert/so_meta_course/commit/2855cc1e4a2154996c5a6af164005cf792f24fd5">I&rsquo;ve filled out the relevant details of the gemspec file</a>.</p>

<h3>Testing</h3>

<p>A Rails tutorial wouldn&rsquo;t be complete without a discussion on Testing. Whether you do it now or not, testing is a great practice to get used to. If you&rsquo;re interested in releasing open source projects, the community will generally take your work more seriously if you prove that it works and the tests are green (this is another way to say that all automated tests are passing &ndash; each passing test is represented by a green dot).</p>

<p><a href="http://en.wikipedia.org/wiki/Test-driven_development">Test-driven development (TDD)</a> is the practice of writing tests before you write the code. This causes you to only write the code that is necessary to make the tests pass and helps to keep us on track (notice a pattern here?!?!).</p>

<p>There are 2 camps in the Ruby/Rails community. One prefers <a href="https://github.com/seattlerb/minitest">Minitest</a> (it&rsquo;s built-in to the Ruby language standard libary), and the other would rather <a href="https://relishapp.com/rspec">Rspec</a>. I fall in to the latter and use Rspec daily. I&rsquo;ve found it fits my needs a little better and I prefer the language it uses around organizing groups of tests.</p>

<p>In order to add it to our gem, let&rsquo;s open the <code>so_meta.gemspec</code> file and add the following to the dependencies section:</p>

<figure class='code'><pre><code>  spec.add_development_dependency "rspec"</code></pre></figure>


<p>Go to a command prompt from the root of your gem and run:</p>

<figure class='code'><pre><code>bundle install</code></pre></figure>


<p>This will install all the dependencies (include Rspec) that is listed in the gemspec. The output will look something like this:</p>

<figure class='code'><pre><code>Fetching gem metadata from https://rubygems.org/.........
Fetching gem metadata from https://rubygems.org/..
Resolving dependencies...
Using rake (10.1.0)
Using bundler (1.3.5)
Using diff-lcs (1.2.5)
Using rspec-core (2.14.7)
Using rspec-expectations (2.14.4)
Using rspec-mocks (2.14.4)
Installing rspec (2.14.1)
Using so_meta (0.0.1) from source at /Users/bhilkert/Dropbox/code/so_meta_course
Your bundle is complete!
Use `bundle show [gemname]` to see where a bundled gem is installed.</code></pre></figure>


<p>Don&rsquo;t get too caught in the version numbers, they will quickly change depending on the time. As you can see, <code>bundler</code> has installed <code>rake</code>, <code>rspec</code> (several gems make up the rspec gem), and our gem <code>so_meta</code>.</p>

<p>To finish the setup of Rspec, run the following from a root directory command prompt:</p>

<figure class='code'><pre><code>rspec --init</code></pre></figure>


<p>The output will look something like:</p>

<figure class='code'><pre><code>  create   spec/spec_helper.rb
  create   .rspec</code></pre></figure>


<p>This has created a <code>spec</code> directory in our project and add the file <code>spec_helper.rb</code> to that directory. This will generally be used as a support file for our specs and, in most cases, all our future specs will require it.</p>

<p>We need to make one other addition to the <code>spec_helper.rb</code> file. Since our we&rsquo;ll be testing our gem, we need to require it from the <code>spec_helper.rb</code>:</p>

<p>Add <code>require "so_meta"</code> to the top, giving us this:</p>

<figure class='code'><pre><code>require "so_meta"

# This file was generated by the `rspec --init` command. Conventionally, all
# specs live under a `spec` directory, which RSpec adds to the `$LOAD_PATH`.
# Require this file using `require "spec_helper"` to ensure that it is only
# loaded once.
#
# See http://rubydoc.info/gems/rspec-core/RSpec/Core/Configuration
RSpec.configure do |config|
  config.treat_symbols_as_metadata_keys_with_true_values = true
  config.run_all_when_everything_filtered = true
  config.filter_run :focus

  # Run specs in random order to surface order dependencies. If you find an
  # order dependency and want to debug it, you can fix the order by providing
  # the seed, which is printed after each run.
  #     --seed 1234
  config.order = 'random'
end</code></pre></figure>


<p>Here are the <a href="https://github.com/brandonhilkert/so_meta_course/commit/ea8a31f18f0affb40bd1c9637311001196372438">changes we&rsquo;ve made to install and setup Rspec</a>.</p>

<p>At this point, you should be able to go to a command prompt and run <code>rspec spec</code> (not ironically, <code>rspec</code> is the command used to initiate the rspec tests &ndash; it takes file path arguments, can be a file or directory, to determine which tests to run) and get the following output:</p>

<figure class='code'><pre><code>No examples found.


Finished in 0.00007 seconds
0 examples, 0 failures</code></pre></figure>


<p>This tells us that our spec infrastructure is setup properly and it&rsquo;s ready to run the specs we&rsquo;ll write.</p>

<p>That&rsquo;s enough for today! I know it probably feels like we&rsquo;ve been moving slow. However, I think it&rsquo;s valuable to know what&rsquo;s going on every step of the way and the reasons we&rsquo;re making the changes that we are. I promise you that the prep and setup is behind us and the next lesson will be all code, all the time :)</p>
</div>
  


</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">

	
  <a href="http://bufferapp.com/add" class="buffer-add-button" data-count="horizontal" data-via="brandonhilkert" >Buffer</a>
  <script type="text/javascript" src="http://static.bufferapp.com/js/button.js"></script>
	

	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	

	
	<a class="addthis_button_tweet"></a>
	

	
  <script type="IN/Share" data-counter="right"></script>
	

	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	

	<!-- <a class="addthis_counter addthis_pill_style"></a> -->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>
			</div>
      
        <footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - Brandon Hilkert
</p>
</footer>
        <script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'brandonhilkert';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://brandonhilkert.com/courses/build-a-ruby-gem/testing.html';
        var disqus_url = 'http://brandonhilkert.com/courses/build-a-ruby-gem/testing.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



      
		</div>
	</div>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24469169-1', 'brandonhilkert.com');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>

</body>
</html>
